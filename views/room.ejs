<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<title>객실관리</title>
	<link rel="stylesheet" type="text/css" href="room.css">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script src="http://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>
	<script>
		$(document).ready(function () {
			$(".using.room301 .open").on('click', function () {
				$(".popup.room301").show();
				$(".dim").show();
			});
			$(".using.room303 .open").on('click', function () {
				$(".popup.room303").show();
				$(".dim").show();
			});
			$(".popup .close").on('click', function () {
				$(this).parent().parent().hide();
				$(".dim").hide();
			});
			$('.commit').on('click', function () {
				$(this).hide();
				$('#inputbox').hide();
				$('.modify').show();
				$('#result').show();
			});
			$('.modify').on('click', function () {
				$(this).hide();
				$('#result').hide();
				$('#inputbox').show();
				$('.commit').show();
			})
		});
	</script>

	<!-- 자동 새로고침을 위한 코드 -->
	<script>
		setTimeout(function(){
			location.reload();
		},3000); // 3000 ms == 3 s
	</script>

	<!--특이사항 입력을 위한 부분 : 입력한대로 화면 출력 및 저장-->
	<script>
		window.onload = function () {
			document.getElementById("save").onclick = processText;
		}
		function processText() {
			var txtBox = document.getElementById("inputbox");
			var lines = txtBox.value.split("\n");
			var resultString = `<ul class="resultString">`;
			for (var i = 0; i < lines.length; i++) {
				resultString += '<li>' + lines[i] + '</li>';
			}
			resultString += '</ul>';
			var blk = document.getElementById("result");
			blk.innerHTML = resultString;
		}   
	</script>
	<!-- 층별보기 -->
    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
    <script>
        $(document).ready(function(){
            $('#floor3').click(function(){
                var offset = $('#301').offset(); //선택한 태그의 위치를 반환
                $('.table').animate({scrollTop : offset.top}, 400);
            });
			$('#floor4').click(function(){
                var offset = $('#401').offset();
                $('.table').animate({scrollTop : offset.top}, 400);
            });
			$('#floor5').click(function(){
                var offset = $('#501').offset();
                $('.table').animate({scrollTop : offset.top}, 400);
            });
			$('#floor6').click(function(){
                var offset = $('#601').offset();
                $('.table').animate({scrollTop : offset.top}, 400);
            });
			$('#floor7').click(function(){
                var offset = $('#701').offset();
                $('.table').animate({scrollTop : offset.top}, 400);
            });
			$('#floor8').click(function(){
                var offset = $('#801').offset();
                $('.table').animate({scrollTop : offset.top}, 400);
            });
			$('#floor9').click(function(){
                var offset = $('#901').offset();
                $('.table').animate({scrollTop : offset.top}, 400);
            });
			$('#floor10').click(function(){
                var offset = $('#1001').offset();
                $('.table').animate({scrollTop : offset.top}, 400);
            });
			$('#floor11').click(function(){
                var offset = $('#1101').offset();
                $('.table').animate({scrollTop : offset.top}, 400);
            });
			$('#floor12').click(function(){
                var offset = $('#1201').offset();
                $('.table').animate({scrollTop : offset.top}, 400);
            });
        });
    </script>
</head>

<body>
	<%- include('./nav'); %>
	<div class="body">
		<!-- 층별보기 -->
        <div class = "floor">
            <button id="floor3"><div class="button">3층</div></button>
            <div id=""></div>
            <button id="floor4"><div class="button">4층</div></button>
            <div id=""></div>
            <button id="floor5"><div class="button">5층</div></button>
            <div id=""></div>
            <button id="floor6"><div class="button">6층</div></button>
			<div id=""></div>
			<button id="floor7"><div class="button">7층</div></button>
            <div id=""></div>
            <button id="floor8"><div class="button">8층</div></button>
            <div id=""></div>
            <button id="floor9"><div class="button">9층</div></button>
            <div id=""></div>
            <button id="floor10"><div class="button">10층</div></button>
			<div id=""></div>
			<button id="floor11"><div class="button">11층</div></button>
            <div id=""></div>
            <button id="floor12"><div class="button">12층</div></button>
            <div id=""></div>
        </div>

		<div class="table">
			<% for (var i = 0, j=0; i < rooms.length; i++) { %>
				<%var empty = 1; %>
			<% if (j < stayrooms.length && rooms[i].number === stayrooms[j].room) { %> <% empty = 0;} %>
			
			<div class= "<% if (!empty){%> using <%}%> <%="room"+String(rooms[i].number)%>">
				<p style="margin: 0; font-weight: bold; margin-left: 2px;"><%- rooms[i].number %></p>
				<% if (!empty) { %>
				<div style="border: none; margin-top: 10px; display: flex;">
					<% if (rooms[i].number === 301) { %> <span id="301"> </span> <% } %>
					<% if (rooms[i].number === 401) { %> <span id="401"> </span> <% } %>
					<% if (rooms[i].number === 501) { %> <span id="501"> </span> <% } %>
					<% if (rooms[i].number === 601) { %> <span id="601"> </span> <% } %>
					<% if (rooms[i].number === 701) { %> <span id="701"> </span> <% } %>
					<% if (rooms[i].number === 801) { %> <span id="801"> </span> <% } %>
					<% if (rooms[i].number === 901) { %> <span id="901"> </span> <% } %>
					<% if (rooms[i].number === 1001) { %> <span id="1001"> </span> <% } %>
					<% if (rooms[i].number === 1101) { %> <span id="1101"> </span> <% } %>
					<% if (rooms[i].number === 1201) { %> <span id="1201"> </span> <% } %>
					<div style="border: none;">
						<a href="#a"><svg class="icon_checkout" width="22" height="22" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd">
								<path d="M11 21h8v-2l1-1v4h-9v2l-10-3v-18l10-3v2h9v5l-1-1v-3h-8v18zm10.053-9l-3.293-3.293.707-.707 4.5 4.5-4.5 4.5-.707-.707 3.293-3.293h-9.053v-1h9.053z" />
								</svg></a>
						<div style="margin-top: 20px; border: none; padding: 0;">
							<% if (stayrooms[j].nationality !== '') {%>
								<img src=<%=stayrooms[j].nationality+".png" %> width="22" style="border: none;">
							<% } %>
						</div>
					</div>
					<div style="border: none; margin-left: 20px; width: 144px; height: 74px;">
						<svg xmlns="http://www.w3.org/2000/svg" width="70" height="70" viewBox="0 0 24 24">
							<path d="M19 7.001c0 3.865-3.134 7-7 7s-7-3.135-7-7c0-3.867 3.134-7.001 7-7.001s7 3.134 7 7.001zm-1.598 7.18c-1.506 1.137-3.374 1.82-5.402 1.82-2.03 0-3.899-.685-5.407-1.822-4.072 1.793-6.593 7.376-6.593 9.821h24c0-2.423-2.6-8.006-6.598-9.819z" />
						</svg>
					</div>
				</div>
				<% } else { %>
				<div style="width: 140px; height: 78px; padding: 2px; margin-top: 10px; border: none;"></div>
				<% } %>
				<p id="status" style="margin-top: 9px;">
					<% if (!empty && stayrooms[j].cleaning === 0) { %>
					<svg id="trashcan" class="status_icon fill" xmlns="http://www.w3.org/2000/svg" width="24"
						height="24" viewBox="0 0 24 24">
						<path
							d="M3 6v18h18v-18h-18zm5 14c0 .552-.448 1-1 1s-1-.448-1-1v-10c0-.552.448-1 1-1s1 .448 1 1v10zm5 0c0 .552-.448 1-1 1s-1-.448-1-1v-10c0-.552.448-1 1-1s1 .448 1 1v10zm5 0c0 .552-.448 1-1 1s-1-.448-1-1v-10c0-.552.448-1 1-1s1 .448 1 1v10zm4-18v2h-20v-2h5.711c.9 0 1.631-1.099 1.631-2h5.315c0 .901.73 2 1.631 2h5.712z" />
						</svg>
					<% } else {%>
					<svg id="trashcan" class="status_icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
						viewBox="0 0 24 24">
						<path
							d="M3 6v18h18v-18h-18zm5 14c0 .552-.448 1-1 1s-1-.448-1-1v-10c0-.552.448-1 1-1s1 .448 1 1v10zm5 0c0 .552-.448 1-1 1s-1-.448-1-1v-10c0-.552.448-1 1-1s1 .448 1 1v10zm5 0c0 .552-.448 1-1 1s-1-.448-1-1v-10c0-.552.448-1 1-1s1 .448 1 1v10zm4-18v2h-20v-2h5.711c.9 0 1.631-1.099 1.631-2h5.315c0 .901.73 2 1.631 2h5.712z" />
						</svg>
					<% } %>

					<% if (!empty && stayrooms[j].cardkey === 1) { %>
					<svg id="key" class="status_icon fill" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
						viewBox="0 0 24 24">
						<path
							d="M12.451 17.337l-2.451 2.663h-2v2h-2v2h-6v-1.293l7.06-7.06c-.214-.26-.413-.533-.599-.815l-6.461 6.461v-2.293l6.865-6.949c1.08 2.424 3.095 4.336 5.586 5.286zm11.549-9.337c0 4.418-3.582 8-8 8s-8-3.582-8-8 3.582-8 8-8 8 3.582 8 8zm-3-3c0-1.104-.896-2-2-2s-2 .896-2 2 .896 2 2 2 2-.896 2-2z" />
						</svg>
					<% } else {%>
					<svg id="key" class="status_icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
						viewBox="0 0 24 24">
						<path
							d="M12.451 17.337l-2.451 2.663h-2v2h-2v2h-6v-1.293l7.06-7.06c-.214-.26-.413-.533-.599-.815l-6.461 6.461v-2.293l6.865-6.949c1.08 2.424 3.095 4.336 5.586 5.286zm11.549-9.337c0 4.418-3.582 8-8 8s-8-3.582-8-8 3.582-8 8-8 8 3.582 8 8zm-3-3c0-1.104-.896-2-2-2s-2 .896-2 2 .896 2 2 2 2-.896 2-2z" />
						</svg>
					<% } %>
					<% if (!empty && stayrooms[j].request != '') { %>
					<svg id="docs" class="status_icon fill" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
						viewBox="0 0 24 24">
						<path
							d="M21.155 8.64c-.909 1.519-2.327 3.067-4.097 3.004-.413.706-.852 1.677-1.339 2.803l-1.312.553c.936-2.343 2.231-4.961 3.698-6.994-.67.529-1.746 1.637-2.662 2.783-1.098-1.828-.3-3.691.973-5.179.021.641.359 1.196.601 1.475-.087-.53-.114-1.489.195-2.351.718-.732 1.364-1.271 2.113-1.76-.083.478.08 1.026.262 1.361.024-.49.224-1.43.521-1.84.924-.727 2.332-1.373 3.892-1.495-.081.973-.436 2.575-1.024 3.604-.515.404-1.221.68-1.791.833.493.089 1.031.077 1.494-.001-.269.743-.552 1.428-.998 2.276-.679.468-1.578.732-2.203.825.46.187 1.272.245 1.677.103zm-13.841 3.805l.645.781 4.773-2.791-.668-.768-4.75 2.778zm6.96-.238l-.668-.767-4.805 2.808.645.781 4.828-2.822zm4.679.007c-.421.203-.851.341-1.286.398-.12.231-.246.494-.377.773l.298.342c.623.692.459 1.704-.376 2.239-.773.497-5.341 3.376-6.386 4.035-.074-.721-.358-1.391-.826-1.948-.469-.557-6.115-7.376-7.523-9.178-.469-.6-.575-1.245-.295-1.816.268-.549.842-.918 1.43-.918.919 0 1.408.655 1.549 1.215.16.641-.035 1.231-.623 1.685l1.329 1.624 7.796-4.446c1.422-1.051 1.822-2.991.93-4.513-.618-1.053-1.759-1.706-2.978-1.706-1.188 0-.793-.016-9.565 4.475-1.234.591-2.05 1.787-2.05 3.202 0 .87.308 1.756.889 2.487 1.427 1.794 7.561 9.185 7.616 9.257.371.493.427 1.119.15 1.673-.277.555-.812.886-1.429.886-.919 0-1.408-.655-1.549-1.216-.156-.629.012-1.208.604-1.654l-1.277-1.545c-.822.665-1.277 1.496-1.377 2.442-.232 2.205 1.525 3.993 3.613 3.993.596 0 1.311-.177 1.841-.51l9.427-5.946c.957-.664 1.492-1.781 1.492-2.897 0-.745-.24-1.454-.688-2.003l-.359-.43zm-7.933-10.062c.188-.087.398-.134.609-.134.532 0 .997.281 1.243.752.312.596.226 1.469-.548 1.912l-5.097 2.888c-.051-1.089-.579-2.081-1.455-2.732l5.248-2.686zm2.097 13.383l.361-.905.249-.609-3.449 2.017.645.781 2.194-1.284z" />
						</svg>
					<% } else {%>
					<svg id="docs" class="status_icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
						<path d="M21.155 8.64c-.909 1.519-2.327 3.067-4.097 3.004-.413.706-.852 1.677-1.339 2.803l-1.312.553c.936-2.343 2.231-4.961 3.698-6.994-.67.529-1.746 1.637-2.662 2.783-1.098-1.828-.3-3.691.973-5.179.021.641.359 1.196.601 1.475-.087-.53-.114-1.489.195-2.351.718-.732 1.364-1.271 2.113-1.76-.083.478.08 1.026.262 1.361.024-.49.224-1.43.521-1.84.924-.727 2.332-1.373 3.892-1.495-.081.973-.436 2.575-1.024 3.604-.515.404-1.221.68-1.791.833.493.089 1.031.077 1.494-.001-.269.743-.552 1.428-.998 2.276-.679.468-1.578.732-2.203.825.46.187 1.272.245 1.677.103zm-13.841 3.805l.645.781 4.773-2.791-.668-.768-4.75 2.778zm6.96-.238l-.668-.767-4.805 2.808.645.781 4.828-2.822zm4.679.007c-.421.203-.851.341-1.286.398-.12.231-.246.494-.377.773l.298.342c.623.692.459 1.704-.376 2.239-.773.497-5.341 3.376-6.386 4.035-.074-.721-.358-1.391-.826-1.948-.469-.557-6.115-7.376-7.523-9.178-.469-.6-.575-1.245-.295-1.816.268-.549.842-.918 1.43-.918.919 0 1.408.655 1.549 1.215.16.641-.035 1.231-.623 1.685l1.329 1.624 7.796-4.446c1.422-1.051 1.822-2.991.93-4.513-.618-1.053-1.759-1.706-2.978-1.706-1.188 0-.793-.016-9.565 4.475-1.234.591-2.05 1.787-2.05 3.202 0 .87.308 1.756.889 2.487 1.427 1.794 7.561 9.185 7.616 9.257.371.493.427 1.119.15 1.673-.277.555-.812.886-1.429.886-.919 0-1.408-.655-1.549-1.216-.156-.629.012-1.208.604-1.654l-1.277-1.545c-.822.665-1.277 1.496-1.377 2.442-.232 2.205 1.525 3.993 3.613 3.993.596 0 1.311-.177 1.841-.51l9.427-5.946c.957-.664 1.492-1.781 1.492-2.897 0-.745-.24-1.454-.688-2.003l-.359-.43zm-7.933-10.062c.188-.087.398-.134.609-.134.532 0 .997.281 1.243.752.312.596.226 1.469-.548 1.912l-5.097 2.888c-.051-1.089-.579-2.081-1.455-2.732l5.248-2.686zm2.097 13.383l.361-.905.249-.609-3.449 2.017.645.781 2.194-1.284z" />
					</svg>
					<% } %>
					<svg class="icon_plus <%="room"+String(rooms[i].number)%> open" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
						<path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm6 13h-5v5h-2v-5h-5v-2h5v-5h2v5h5v2z" />
					</svg>
				</p>
			</div>
			<% if(!empty){j++}%>
			<% } %>
		</div>
		<!-- request도 분리하는 게 좋을 지도 ? -->
		<div id="request">
			<div class="list">
				<div id="requestItem">
					<p class='title'>
						제목1
					</p>
					<p class="content">
						내용1
					</p>
				</div>

				<div id="requestItem">
					<p class='title'>
						제목2
					</p>
					<p class="content">
						내용2
					</p>
				</div>

				<div id="requestItem">
					<p class='title'>
						제목3
					</p>
					<p class="content">
						내용3
					</p>
				</div>

				<div id="requestItem">
					<p class='title'>
						제목4
					</p>
					<p class="content">
						내용4
					</p>
				</div>

				<div id="requestItem">
					<p class='title'>
						제목5
					</p>
					<p class="content">
						내용5
					</p>
				</div>

				<div id="requestItem">
					<p class='title'>
						제목6
					</p>
					<p class="content">
						내용6
					</p>
				</div>

				<div id="requestItem">
					<p class='title'>
						제목7
					</p>
					<p class="content">
						내용7
					</p>
				</div>

				<div id="requestItem">
					<p class='title'>
						제목8
					</p>
					<p class="content">
						내용8
					</p>
				</div>

				<div id="requestItem">
					<p class='title'>
						제목9
					</p>
					<p class="content">
						내용9
					</p>
				</div>
			</div>
			<button>+</button>
		</div>
	</div>


	<!-- popup도 분리하는 게 좋을 지도 ? -->
	<% for (var i = 0, j=0; i < stayrooms.length; i++) { %>
	<div class="popup room<%=stayrooms[i].room%>">
		<!-- 호실 이름도 서버에서 받아온 데이터로 출력하기-->
		<div style="text-align: right;">
			<a href="#a" class="close"><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg"
					fill-rule="evenodd" clip-rule="evenodd">
					<path
						d="M12 11.293l10.293-10.293.707.707-10.293 10.293 10.293 10.293-.707.707-10.293-10.293-10.293 10.293-.707-.707 10.293-10.293-10.293-10.293.707-.707 10.293 10.293z" />
					</svg></a>

		</div>
		<h2><%=stayrooms[i].room%>호</h2>
		<div>
			<table class="type1">
				<caption>
					<!-- <details class="hide">
                        <summary>호실 별 세부사항</summary>
                        <div>미결제 금액, 담당 직원, 입실 시간, 퇴실 예정 시간, 특이사항, 투숙 인원</div>
                    </details> -->
				</caption>
				<colgroup>
					<col style="width: 111px">
					<col>
				</colgroup>
				<tbody>
					<tr>
						<th>미결제 금액</th>
						<td><%=stayrooms[i].should_paid%> 원</td>
						<!-- %=data[temp].name% -->
					</tr>
					<tr>
						<th>담당 직원</th>
						<td><%=stayrooms[i].staff_name%></td>
					</tr>
					<tr>
						<th>입실 시간</th>
						<td><%=stayrooms[i].checkin%></td>
					</tr>
					<tr>
						<th>퇴실 예정 시간</th>
						<td><%=stayrooms[i].checkout%></td>
					</tr>
					<tr>
						<th style="height: 150px;">특이 사항</th>
						<td>
							<textarea id="inputbox" cols="43" rows="6"></textarea>
							<div><button id="save" class="commit">저장</button></div>
							<div id="result"></div>
							<div><button class="modify">수정</button></div>
						</td>
					</tr>
					<tr>
						<th><label for="txt6">투숙 인원</label></th>
						<td>5</td>
					</tr>
				</tbody>
			</table>
		</div>
		<div style="text-align: right; margin-top: 50px;">
			<a href="#a" class="btn"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
					<path
						d="M15 16v5l9-10.062-9-9.938v5c-14.069 1.711-19.348 15.107-10.606 16.981-3.804-2.936 3.251-7.441 10.606-6.981z" />
					</svg>방이동</a>
			<a href="#a" class="btn"><svg width="22" height="22" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd"
					clip-rule="evenodd">
					<path
						d="M11 21h8v-2l1-1v4h-9v2l-10-3v-18l10-3v2h9v5l-1-1v-3h-8v18zm10.053-9l-3.293-3.293.707-.707 4.5 4.5-4.5 4.5-.707-.707 3.293-3.293h-9.053v-1h9.053z" />
					</svg>체크아웃</a>
		</div>
	</div>
	<div class="dim"></div>
	<% if(!empty){j++}%>
	<% } %>
</body>

</html>